# Where are you building?
export BUILDROOT=????

cd $BUILDROOT
mkdir cross
mkdir cross/b
mkdir cross/d
mkdir cross/krita-build

git clone git@github.com:boudewijnrempt/mxe.git
cd mxe
export PATH=$BUILDROOT/mxe/usr:$BUILDROOT/mxe/usr/x86_64-w64-mingw32.shared/qt5/bin:$PATH

# note: poppler-qt5 and gsl don't work yet
# Use  i686-w64-mingw32.shared for 32 bits builds

make MXE_TARGETS=x86_64-w64-mingw32.shared gcc boost curl eigen exiv2 expat fftw fontconfig freetype gettext ilmbase openexr jpeg lcms libpng libraw opencolorio openjpeg qt5 qtscript tiff vc zlib

cd $BUILDROOT
git clone git://anongit.kde.org/krita.git

cd b

x86_64-w64-mingw32.shared-cmake ../krita/3rdparty/ -DEXTERNALS_DOWNLOAD_DIR=$BUILDROOT/d -DINSTALL_ROOT=$BUILDROOT/mxe/usr/x86_64-w64-mingw32.shared -DMXE_TOOLCHAIN=${BUILDROOT}/mxe/usr/i686-w64-mingw32.shared/share/cmake/mxe-conf.cmake

cmake --build . --target ext_kwindowsystem
